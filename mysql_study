mysql manual:
  http://dev.mysql.com/doc/refman/5.7/en/using-explain.html

?? which is more efficient: accessing db multiple times on different tables or by joining tables?


---------- 2016-11-08 16:11:54
http://www.linuxidc.com/Linux/2013-07/88032.htm
é¦–å…ˆï¼Œå¯¹äºç²¾åº¦æ¯”è¾ƒé«˜çš„ä¸œè¥¿ï¼Œæ¯”å¦‚moneyï¼Œæˆ‘ä¼šç”¨decimalç±»å‹ï¼Œä¸ä¼šè€ƒè™‘float,double,å› ä¸ºä»–ä»¬å®¹æ˜“äº§ç”Ÿè¯¯å·®ï¼Œnumericå’ŒdecimalåŒä¹‰ï¼Œnumericå°†è‡ªåŠ¨è½¬æˆdecimalã€‚
DECIMALä»MySQL 5.1å¼•å…¥ï¼Œåˆ—çš„å£°æ˜è¯­æ³•æ˜¯DECIMAL(M,D)ã€‚åœ¨MySQL 5.1ä¸­ï¼Œå‚é‡çš„å–å€¼èŒƒå›´å¦‚ä¸‹ï¼š
Â·Mæ˜¯æ•°å­—çš„æœ€å¤§æ•°ï¼ˆç²¾åº¦ï¼‰ã€‚å…¶èŒƒå›´ä¸º1ï½65ï¼ˆåœ¨è¾ƒæ—§çš„MySQLç‰ˆæœ¬ä¸­ï¼Œå…è®¸çš„èŒƒå›´æ˜¯1ï½254ï¼‰ï¼ŒM çš„é»˜è®¤å€¼æ˜¯10ã€‚
Â·Dæ˜¯å°æ•°ç‚¹å³ä¾§æ•°å­—çš„æ•°ç›®ï¼ˆæ ‡åº¦ï¼‰ã€‚å…¶èŒƒå›´æ˜¯0ï½30ï¼Œä½†ä¸å¾—è¶…è¿‡Mã€‚
è¯´æ˜ï¼šfloatå 4ä¸ªå­—èŠ‚ï¼Œdoubleå 8ä¸ªå­—èŠ‚ï¼Œdecimail(M,D)å M+2ä¸ªå­—èŠ‚ã€‚
å¦‚DECIMAL(5,2) çš„æœ€å¤§å€¼ä¸º9 9 9 9 . 9 9ï¼Œå› ä¸ºæœ‰7 ä¸ªå­—èŠ‚å¯ç”¨ã€‚

if the left is too big, error. [left + right is no longer than M, and right is no longer than D]
if the right is too long, truncate.

mysql> INSERT INTO `wind_wsi` (`code`,`name`,`create_at`,`date`,`open`,`high`,`low`,`close`,`volume`,`amt`,`chg`,`pct_chg`) VALUES ("000001.SH","ä¸Šè¯ç»¼æŒ‡",NOW(),"2016-11-08 09:31:00","3140.967200","3140.967201","3140.967202","3140.967203","3140.967204","3140.967205","3140.967206","55555553140.967207151515151");
ERROR 1264 (22003): Out of range value for column 'pct_chg' at row 1

DROP TABLE IF EXISTS `wind_wsi_bak`;
CREATE TABLE `wind_wsi_bak` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `code` varchar(32) NOT NULL COMMENT 'è¯åˆ¸ä»£ç ',
  `name` varchar(512) DEFAULT NULL COMMENT 'è¯åˆ¸åç§°',
  `create_at` timestamp NULL DEFAULT NULL,
  `date` datetime NOT NULL,
  `open` decimal(30, 20) DEFAULT 0 COMMENT 'å¼€ç›˜ä»·',
  `high` decimal(30, 20) DEFAULT 0 COMMENT 'æœ€é«˜ä»·',
  `low` decimal(30, 20) DEFAULT 0 COMMENT 'æœ€ä½ä»·',
  `close` decimal(30, 20) DEFAULT 0 COMMENT 'æ”¶ç›˜ä»·',
  `volume` decimal(30, 20) DEFAULT 0 COMMENT 'æˆäº¤é‡',
  `amt` decimal(30, 20) DEFAULT 0 COMMENT 'æˆäº¤é¢',
  `chg` decimal(30, 20) DEFAULT 0 COMMENT 'æ¶¨è·Œ',
  `pct_chg` decimal(30, 20) DEFAULT 0 COMMENT 'æ¶¨è·Œå¹…',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

INSERT INTO `wind_wsi_bak`
(`code`,`name`,`create_at`,`date`,`open`,`high`,`low`,`close`,`volume`,`amt`,`chg`,`pct_chg`)
VALUES
("000001.SH","ä¸Šè¯ç»¼æŒ‡",NOW(),str_to_date("20161108 09:30:00",'%Y%m%d %H:%i:%s'),"3140.967200","3140.967201","3140.967202","3140.967203","3140.967204","3140.967205","3140.967206","3140.967207151515151");

----------- 2016-11-03 14:55:00
if not commented below commented lines, the lower part will cost 1 more second.

2016-11-03 14:52:05 [10.12.0.36][18][-][error][abc\backend\admin\components\PlazaManager::getMissionRecommendList] spent time ms: 32.968997955322 and 1388.1499767303

compared to:

2016-11-03 14:53:08 [10.12.0.36][18][-][error][abc\backend\admin\components\PlazaManager::getMissionRecommendList] spent time ms: 34.518003463745 and 5.1229000091553

            $midtime    = microtime(true);
            foreach ($missions as $mission) {
//                if ($mission->isStoped()) {
//                    continue;
//                }
//                if (is_null($mission->creator)) {
//                    continue;
//                }
                $data[] = [
                    'mid' => $mission->id,
                    'mt' => $mission->missiontype,
                    'name' => $mission->name,
//                    'creator_name' => $mission->creator->nickname,
                    'create_time' => $mission->create_time,
                    'announce' => $mission->announce,
                    'description' => $mission->description,
                    'start_time' => $mission->startTime,
                    'stop_time' => $mission->stopTime,
                    'ticket' => $mission->ticket,
                    'offical_recommend_time'=> $mission->offical_recommend_time,
                    'user_recommend_count'=> $mission->user_recommend_count,
                ];
            }
            $endTime    = microtime(true);
            $mid    = ($midtime - $startTime) * 1000; //å°†æ—¶é—´è½¬æ¢ä¸ºæ¯«ç§’
            $runtime    = ($endTime - $midtime) * 1000; //å°†æ—¶é—´è½¬æ¢ä¸ºæ¯«ç§’
            \frontend\components\util\Logger::error('spent time ms: ' . $mid . ' and ' . $runtime);
        }

--------- 2016-10-21 12:09:27

                Account::updateAll(
                    ['nickname' => $nickname, 'username' => $nickname, 'updated_at' => new \yii\db\Expression('NOW()')],
                    ['id' => $user->account_id]
                );

                
------------- 2016-10-21 10:14:45
mysql> select a.id, b.name, b.id from challenge as a, mission as b where a.mission_id = b.id and a.user_id=14;
+-----+---------------------------------------------------+-----+
| id  | name                                              | id  |
+-----+---------------------------------------------------+-----+
|  64 | å¯†äº‘ä¼šè®®å®šæ—¶ç­¾åˆ°                                  |  54 |
|  80 | æŒ‘æˆ˜å·èˆŒå¤´                                        |  55 |
| 195 | çº¢åŒ…é¢†å–                                          |  29 |
| 245 | åˆ†çº¢åŒ…                                            |  47 |
| 247 | ä¸€èµ·æµ‹è¯•å§                                        |  48 |
| 253 | åˆ°äº†ä¼šåœºå†æ‰“å¡                                    | 185 |
| 255 | å¤œæ™šçš„ä¼šè®®å¸Œæœ›å¤§å®¶éƒ½èƒ½å‚ä¸                        |  50 |
| 256 | æˆæœ‹æµ‹è¯•                                          |  51 |
| 332 | å¤œæ™šçš„å›å¿†å¸Œæœ›                                    |  69 |
| 395 | åŒ—äº¬åŠå…¬å®¤åº†ä¸­ç§‹!                                 | 216 |
| 442 | ä¸­ç§‹æ¬¢ä¹å®¶åº­å¤§è¶´ä½“                                | 228 |
| 461 | å›åˆ°å®¶æ‰“å¼€å°é—­                                    | 242 |
| 462 | å›åˆ°å®¶é…’åº—                                        | 243 |
| 463 | é˜¿æ–¯é¡¿æ³•å›½                                        | 244 |
| 527 | æ•£æ­¥                                              | 108 |
| 576 | ä¸€                                                | 121 |
| 623 | æ—©é¤æŒ‘æˆ˜ç¬¬ä¸€å£é€ å‹-ç­‰ä½ ç“œåˆ†å¥–é‡‘æ±                  | 312 |
| 624 | æ—©èµ·æŒ‘æˆ˜-ç“œåˆ†å¥–é‡‘æ±                                | 313 |
| 681 | å•Šè€ƒè™‘è€ƒè™‘                                        | 140 |
+-----+---------------------------------------------------+-----+
19 rows in set (0.00 sec)

---------- 2016-10-19 21:14:43

alter table `card_base` add column `checkin_photo` varchar(1024) DEFAULT NULL;
alter table `card_base` add column `announce` varchar(64) DEFAULT NULL;


alter table `card_base` modify `checkin_photo` varchar(1024) DEFAULT NULL;
alter table è¡¨åç§° modify å­—æ®µåç§° å­—æ®µç±»å‹ [æ˜¯å¦å…è®¸éç©º];

----------- 2016-10-19 18:51:27
ç¬¬å››æ¬¡ æŒ‰ç…§ b cä¸¤ä¸ªæ¡ä»¶æ¥åˆ†ç»„
select count(a),b,c from test group by b,c 

----------- 2016-10-19 14:57:46
http://blog.csdn.net/k8080880/article/details/8482659
1ã€in åé¢æ˜¯è®°å½•é›†ï¼Œå¦‚
select id, nickname from user where id in (select id from user where id>31);
2ã€in åé¢æ˜¯å­—ç¬¦ä¸²
mysql> select id, nickname from user where id in (1, 2, '3');
+----+----------+
| id | nickname |
+----+----------+
|  1 | å¼ äº®     |
|  2 | å¼ äº®     |
|  3 | Justice  |
+----+----------+
3 rows in set (0.00 sec)


-------- 2016-10-08 10:43:38
offset starts from 0:

    SELECT  
        keyword  
    FROM  
        keyword_rank  
    WHERE  
        advertiserid='59'  
    order by  
        keyword  
    LIMIT 2 OFFSET 1;  
æ¯”å¦‚è¿™ä¸ªSQL ï¼Œlimitåé¢è·Ÿçš„æ˜¯2æ¡æ•°æ®ï¼Œoffsetåé¢æ˜¯ä»ç¬¬1æ¡å¼€å§‹è¯»å–
Sqlä»£ç   æ”¶è—ä»£ç 
    SELECT  
        keyword  
    FROM  
        keyword_rank  
    WHERE  
        advertiserid='59'  
    ORDER BY  
        keyword  
    LIMIT 2 ,1;
è€Œè¿™ä¸ªSQLï¼Œlimitåé¢æ˜¯ä»ç¬¬2æ¡å¼€å§‹è¯»ï¼Œè¯»å–1æ¡ä¿¡æ¯ã€‚

------------ 2016-09-28 21:39:40

mysql backup:
mysqldump -h 10.12.0.61 -u tz8_dev -p --databases tz8_dev > /home/anye/test_back.sql

http://www.cnblogs.com/kissdodog/p/4174421.html

ã€€ã€€2ã€å¤‡ä»½å¤šä¸ªæ•°æ®åº“
ã€€ã€€è¯­æ³•ï¼š
mysqldump -u username -p --databases dbname2 dbname2 > Backup.sql
ã€€ã€€åŠ ä¸Šäº†--databasesé€‰é¡¹ï¼Œç„¶ååé¢è·Ÿå¤šä¸ªæ•°æ®åº“
mysqldump -u root -p --databases test mysql > D:\backup.sql
ã€€ã€€3ã€å¤‡ä»½æ‰€æœ‰æ•°æ®åº“
ã€€ã€€mysqldumpå‘½ä»¤å¤‡ä»½æ‰€æœ‰æ•°æ®åº“çš„è¯­æ³•å¦‚ä¸‹ï¼š
mysqldump -u username -p -all-databases > BackupName.sql
ã€€ã€€ç¤ºä¾‹ï¼š
mysqldump -u -root -p -all-databases > D:\all.sql

äºŒã€æ•°æ®è¿˜åŸ
ã€€ã€€1ã€è¿˜åŸä½¿ç”¨mysqldumpå‘½ä»¤å¤‡ä»½çš„æ•°æ®åº“çš„è¯­æ³•å¦‚ä¸‹ï¼š
ã€€ã€€mysql -u root -p [dbname] < backup.sq
ã€€ã€€ç¤ºä¾‹ï¼š
mysql -u root -p < C:\backup.sql
ã€€ã€€2ã€è¿˜åŸç›´æ¥å¤åˆ¶ç›®å½•çš„å¤‡ä»½
ã€€ã€€é€šè¿‡è¿™ç§æ–¹å¼è¿˜åŸæ—¶ï¼Œå¿…é¡»ä¿è¯ä¸¤ä¸ªMySQLæ•°æ®åº“çš„ç‰ˆæœ¬å·æ˜¯ç›¸åŒçš„ã€‚MyISAMç±»å‹çš„è¡¨æœ‰æ•ˆï¼Œå¯¹äºInnoDBç±»å‹çš„è¡¨ä¸å¯ç”¨ï¼ŒInnoDBè¡¨çš„è¡¨ç©ºé—´ä¸èƒ½ç›´æ¥å¤åˆ¶ã€‚

e.g., 
mysqldump -h 10.12.0.61 -u tz8_dev -p --databases tz8_dev > /home/kidd/test_back.sql
mysqldump -h 10.168.76.32 -u tz8_dev -p --databases tz8_dev > /home/ahye/online_test_back.sql
  scp ahye@121.43.153.62:/home/ahye/online_test_back.sql ~/tmp/
~/workspace/bc/advanced/MissionImpossible
$ mysql -u root -p < ~/tmp/online_test_back.sql
Enter password:



--------- 2016-09-18 17:21:14
set names gbk;

Query OK, 0 rows affected (0.00 sec)
å®ƒç›¸å½“äºä¸‹é¢çš„ä¸‰å¥æŒ‡ä»¤ï¼š
SET character_set_client = gbk;
SET character_set_results = gbk;
SET character_set_connection = gbk;
å› æ­¤ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿå¯ä»¥è§£å†³æ‰€æœ‰å­—ç¬¦ç¼–ç è®¾ç½®ä¸ºgbkï¼Œè€Œæ§åˆ¶å°æ˜¾ç¤ºä¸­æ–‡ä¹±ç çš„é—®é¢˜ã€‚

â‘¤å½“ç„¶ä½ ä¹Ÿå¯ä»¥è¯•è¯•SET character_set_client = gbk;  å³setè¿™ç§å‘½ä»¤æ¥ä¿®æ”¹å„ä¸ªå˜é‡ï¼Œä½†å½“æ—¶æˆ‘ä¸çŸ¥é“è¿™ä¸ªï¼Œä¹Ÿæ²¡è¯•è¿‡ã€‚å¦‚æœä½ ä¸Šé¢çš„æ–¹æ³•ä¸è¡Œå¯ä»¥è¯•è¯•è¿™ä¸ªã€‚

with and without
  # [mysql]
  # default-character-set = utf8mb4

mysql> show variables like "%character%";
+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8mb4                    |
| character_set_connection | utf8mb4                    |
| character_set_database   | utf8mb4                    |
| character_set_filesystem | binary                     |
| character_set_results    | utf8mb4                    |
| character_set_server     | latin1                     |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+

mysql> show variables like "%character%";
+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | utf8mb4                    |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | latin1                     |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+
8 rows in set (0.01 sec)

mysql> show create database yii2basic;
+-----------+--------------------------------------------------------------------------------------------------+
| Database  | Create Database                                                                                  |
+-----------+--------------------------------------------------------------------------------------------------+
| yii2basic | CREATE DATABASE `yii2basic` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci */ |
+-----------+--------------------------------------------------------------------------------------------------+


--------- 2016-09-18 10:46:02

mysqlå¢åŠ åˆ—ï¼Œä¿®æ”¹åˆ—åã€åˆ—å±æ€§ï¼Œåˆ é™¤åˆ—
MySQL 
mysqlä¿®æ”¹è¡¨åï¼Œåˆ—åï¼Œåˆ—ç±»å‹ï¼Œæ·»åŠ è¡¨åˆ—ï¼Œåˆ é™¤è¡¨åˆ—
alter table test rename test1; --ä¿®æ”¹è¡¨å
alter table test add  column name varchar(10); --æ·»åŠ è¡¨åˆ—
alter table test drop  column name; --åˆ é™¤è¡¨åˆ—
alter table test modify address char(10) --ä¿®æ”¹è¡¨åˆ—ç±»å‹
||alter table test change address address  char(40)
alter table test change  column address address1 varchar(30)--ä¿®æ”¹è¡¨åˆ—å 

ä¿®æ”¹mysql è¡¨çš„å­—ç¬¦ç¼–ç 
mysql> alter table country convert to character set utf8mb4;
Query OK, 13 rows affected (0.07 sec)
Records: 13  Duplicates: 0  Warnings: 0
å½“ç„¶è¿˜å¯ä»¥è®¾ç½®mysqlçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„é»˜è®¤ç¼–ç 
vi /etc/mysql/my.conf
åœ¨[mysql] ä¸‹é¢ æ·»åŠ   default-character-set=utf8
åœ¨[mysqld] ä¸‹é¢æ·»åŠ  
character-set-server=utf8
collaction-server = utf8-greneral-cli
ä¿®æ”¹å®Œåé‡å¯mysql server

mysql> show create table country;
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table   | Create Table                                                                                                                                                                                       |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| country | CREATE TABLE `country` (
  `code` char(2) NOT NULL,
  `name` varchar(50) DEFAULT NULL,
  `population` int(11) NOT NULL DEFAULT '0',
  PRIMARY KEY (`code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 |



--------- 2016-09-14 18:50:53
http://blog.csdn.net/mr_linjw/article/details/49849691
1. MySQL ä¸ºæ—¥æœŸå¢åŠ ä¸€ä¸ªæ—¶é—´é—´éš”ï¼šdate_add()
[html] view plain copy
    set @dt = now();  
    select date_add(@dt, interval 1 day);   - åŠ 1å¤©  
    select date_add(@dt, interval 1 hour);   -åŠ 1å°æ—¶  
    select date_add(@dt, interval 1 minute);    - åŠ 1åˆ†é’Ÿ  
    select date_add(@dt, interval 1 second); -åŠ 1ç§’  
    select date_add(@dt, interval 1 microsecond);-åŠ 1æ¯«ç§’  
    select date_add(@dt, interval 1 week);-åŠ 1å‘¨  
    select date_add(@dt, interval 1 month);-åŠ 1æœˆ  
    select date_add(@dt, interval 1 quarter);-åŠ 1å­£  
    select date_add(@dt, interval 1 year);-åŠ 1å¹´  
ä¾‹ï¼šæ›´æ–°æŸä¸ªæ—¶é—´ï¼Œæ¯ä¸ªæ—¶é—´åŠ ä¸Šä¸€ä¸ªæ˜ŸæœŸ
[html] view plain copy
    UPDATE comment c set c.time = DATE_ADD(c.time, INTERVAL 7 DAY) ;  
2. MySQL ä¸ºæ—¥æœŸå‡å»ä¸€ä¸ªæ—¶é—´é—´éš”ï¼šdate_sub()ï¼Œæ ¼å¼åŒdate_addï¼ˆï¼‰ç±»ä¼¼
ä¾‹å­ï¼šæ›´æ–°æŸä¸ªæ—¶é—´ï¼Œä½¿æ¯ä¸ªæ—¶é—´å‡å°‘ä¸€ä¸ªæœˆ
[html] view plain copy
    UPDATE comment c set c.time = DATE_SUB(c.time, INTERVAL 1 MONTH)

---------- 2016-09-14 17:50:39
mysql> select checkin.id, day(checkin_time) from checkin, challenge where checkin.challenge_id=challenge.id and challenge.mission_id=128;
+-----+-------------------+
| id  | day(checkin_time) |
+-----+-------------------+
| 379 |                13 |
| 380 |                13 |
| 381 |                13 |
| 382 |                13 |
| 383 |                12 |
| 385 |                12 |
| 386 |                12 |
| 387 |                11 |
| 388 |                11 |
| 389 |                10 |
| 390 |                10 |
| 391 |                10 |
| 392 |                14 |
+-----+-------------------+
13 rows in set (0.00 sec)

mysql> update period_mission set start_time="2016-09-10 16:45:00" where id=128;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select checkin.id, checkin_time from checkin, challenge where checkin.challenge_id=challenge.id and challenge.mission_id=128;
+-----+---------------------+
| id  | checkin_time        |
+-----+---------------------+
| 379 | 2016-09-13 16:45:00 |
| 380 | 2016-09-13 16:45:00 |
| 381 | 2016-09-13 16:45:00 |
| 382 | 2016-09-13 16:45:00 |
| 383 | 2016-09-12 16:45:00 |
| 385 | 2016-09-12 16:45:00 |
| 386 | 2016-09-12 16:45:00 |
| 387 | 2016-09-11 16:45:00 |
| 388 | 2016-09-11 16:45:00 |
| 389 | 2016-09-14 17:45:09 |
| 390 | 2016-09-14 17:45:09 |
| 391 | 2016-09-14 17:46:09 |
+-----+---------------------+
12 rows in set (0.00 sec)

mysql> update checkin set checkin_time="2016-09-10 16:45:00" where id=389;Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> update checkin set checkin_time="2016-09-10 16:45:00" where id=390;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> update checkin set checkin_time="2016-09-10 16:45:00" where id=391;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> update test set name="ä¸€\U+1F604äºŒä¸€\U+1F604äºŒ" where id=1;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from test;
+----+----------------------+------------+
| id | name                 | population |
+----+----------------------+------------+
|  1 | ä¸€ğŸ˜„äºŒä¸€ğŸ˜„äºŒ             |          1 |
|  2 | ğŸ˜„                     |          1 |
|  3 | ä¸€ğŸ˜„äºŒ                 |         12 |
|  4 | ä¸€ğŸ˜„äºŒä¸€ğŸ˜„äºŒ             |         11 |
+----+----------------------+------------+
4 rows in set (0.00 sec)

---------- 2016-09-09 11:14:29
period mission reminder test:

delete from mission_notify where id=1152;
insert into checkin set challenge_id=11898, checkin_time="2016-09-03 10:00:00";
update period_mission set start_time="2016-09-03 00:00:00" where id=1996;

----------- 2016-09-08 15:10:01

insert into `challenge` set mission_id=1917, user_id=4, mission_type=1;
update period_mission set joined_count=2 where id=1917;

------------ 2016-09-06 15:43:52


    private function check() {
        try {
            $now = date('Y-m-d H:i:s');
            $one_hour_in_the_future = date('Y-m-d H:i:s', time()+3600);
            $missions = Mission::find()->where("unix_timestamp(stop_time) > unix_timestamp(\"$now\")")
                ->andWhere("unix_timestamp(stop_time) < unix_timestamp(\"$one_hour_in_the_future\")")
                ->andWhere("unix_timestamp(start_time) < unix_timestamp(\"$now\")")
                ->all();

            foreach ($missions as $mission) {
                if(is_null($mission)) continue;
                $remaining = strtotime($mission->stop_time) - strtotime($now);
                $lifetime = strtotime($mission->stop_time) - strtotime($mission->start_time);

without \"$one_hour_in_the_future\", there might be below error message: 

Next yii\db\Exception: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '15:28:53)) AND (unix_timestamp(stop_time) < unix_timestamp(2016-09-06 16:28:53))' at line 1
The SQL being executed was: SELECT * FROM `mission` WHERE (unix_timestamp(stop_time) > unix_timestamp(2016-09-06 15:28:53)) AND (unix_timestamp(stop_time) < unix_timestamp(2016-09-06 16:28:53)) in /home/kidd/workspace/bc/advanced/MissionImpossible/vendor/yiisoft/yii2/db/Schema.php:633
Stack trace:
#0 /home/kidd/workspace/bc/advanced/MissionImpossible/vendor/yiisoft/yii2/db/Command.php(915): yii\db\Schema->convertException(Object(PDOException), 'SELECT * FROM `...')
#1 /home/kidd/workspace/bc/advanced/MissionImpossible/vendor/yiisoft/yii2/db/Command.php(362): yii\db\Command->queryInternal('fetchAll', NULL)
#2 /home/kidd/workspace/bc/advanced/MissionImpossible/vendor/yiisoft/yii2/db/Query.php(210): yii\db\Command->queryAll()
#3 /home/kidd/workspace/bc/advanced/MissionImpossible/vendor/yiisoft/yii2/db/ActiveQuery.php(133): yii\db\Query->all(NULL)
#4 /home/kidd/workspace/bc/advanced/MissionImpossible/console/tasks/MissionReminderTask.php(37): yii\db\ActiveQuery->all()


---------- 2016-09-06 11:32:31
http://bbs.csdn.net/topics/310121656

åœ¨insert into ... å’Œ select ... where..çš„æ—¶å€™ å¦‚æœå­—æ®µä¸ºæ•°å­—ç±»å‹ï¼Œæ·»åŠ æˆ–è€…æŸ¥è¯¢æ•°æ®æ—¶ï¼Œç»™æ•°å­—æ·»åŠ å¼•å·æ˜¯ä¸æ˜¯å¤šä½™çš„ï¼Ÿ
insert into table (atype) values ('1')
insert into table (atype) values (1)
atypeæ˜¯æ•°å­—å­—æ®µï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½è¡Œå•Šï¼Œå› ä¸ºmysqlæ‰‹å†Œä¸Šé¢çš„ä¸œè¥¿å®åœ¨æ˜¯å¤ªä¹±ï¼Œæ ¹æœ¬æ‰¾ä¸åˆ°ç›¸å…³çš„ä¿¡æ¯ã€‚ 

ä¸å¤šä½™ï¼Œä¸åŠ å¼•å·æ€»è®©äººå¯¹sqlæ³¨å…¥æ„Ÿåˆ°æ‹…å¿ƒï¼Œæ‰€ä»¥åªè¦mysqlçš„sql_modeä¸ä¸¥æ ¼è®¾ç½®(ä¸€èˆ¬å¾ˆå°‘è®¾ç½®ä¸¥æ ¼),éƒ½è¦åŠ å¼•å·ã€‚
ç‰¹åˆ«æ˜¯æŸ¥è¯¢è¯­å¥ï¼Œå¦‚æœä½ select ...whereåé¢çš„æ¡ä»¶å’Œç”¨æˆ·è¾“å…¥ç›¸å…³ï¼Œä¸åŠ å¼•å·åŠ å¤§äº†å—æ”»å‡»çš„å±é™©ç³»æ•°ã€‚

$user_id = $_GET['user_id'];//å‡å¦‚ç”¨æˆ·åœ¨urlé‡Œæ„é€ å‚æ•°ä½¿å¾—$_GET['user_id']ä¸º 1 or 1=1
$sql = "select * from `user` where user_id={$user_id}";//ä¸‹é¢è¿™å¥sqlä¸å°±å˜æˆäº†select * from `user` where user_id=1 or 1=1ï¼Œæ‰€æœ‰useræ•°æ®?

insert into table (atype) values (select something from sometable limit 1) ï¼Œæ‹¬å·é‡Œæ˜¯å¯ä»¥æ„é€ sqlè¯­å¥çš„ï¼ŒæŒ‡ä¸å®šå°±ç»™äººåˆ©ç”¨å»æ”»å‡»äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯åŠ å¼•å·ä¿é™©ç‚¹ã€‚

delete,updateç­‰ä¹Ÿè¦æ³¨æ„æ­¤ç±»é—®é¢˜ã€‚ 

---------- 2016-09-06 11:24:34

http://stackoverflow.com/questions/17541312/alter-table-add-multiple-columns-after-column1
If you want to add single column after specific field, then the mysql query is:
ALTER TABLE users
    ADD COLUMN count SMALLINT(6) NOT NULL
    AFTER lastname
If you want to add multiple columns, then you need to use 'ADD' command each time for a column. The mysql query as follows as:
ALTER TABLE users
    ADD COLUMN count SMALLINT(6) NOT NULL,
    ADD COLUMN log VARCHAR(12) NOT NULL,
    ADD COLUMN status INT(10) UNSIGNED NOT NULL
    AFTER lastname

---------- 2016-08-26 14:54:47

$ mysql -h 10.12.0.1 -u root -p
Enter password: 
ERROR 2003 (HY000): Can't connect to MySQL server on '10.12.0.1' (111)

but localhost works. 
similar issue occurs while using PDO.
  PHP PDO SQLSTATE[HY000] [2002] Connection refused

http://blog.csdn.net/colourless/article/details/43273719
  grant all privileges on *.* to 'root'@'%' identified by 'root';
  flush privileges; // å¬è¯´å®é™…å®ç°æ–¹å¼æ˜¯å°†userå’Œpriviligeè¡¨é‡Œçš„ä¸œè¥¿æ‰”è¿›å†…å­˜ã€‚

sudo /etc/init.d/mysql restart

use mysql;
select Host, User, Password from user;
update user set host='localhost' where Host = '%';

/etc/mysql/my.cnf [commenting below line works, meanwhile, the % record should be there for some user and corresponding pwd, the pwd does not have to be the same as system user]
# bind-address  = 127.0.0.1

---------- 2016-08-25 19:14:51
http://www.cnblogs.com/zcw-ios/articles/3319480.html
mysqldump -h 10.12.0.61 -u tz8_dev tz8_dev qrcode_general > qrcode_general.sql -p
mysqldump -h 10.168.76.32 -u tz8 tz8 qrcode_general > qrcode_general.sql -p

----------- 2016-08-19 11:06:03
mysql> SELECT COUNT(*) FROM `checkin` WHERE checkin.challenge_id = 8620 and TO_DAYS(checkin_time) = TO_DAYS(NOW());



----------- 2016-08-18 17:23:47
//    public function isUserCheckedToday($uid)
//    {
//        $challenge = Challenge::findOne([
//            'mission_id' => $this->id,
//            'mission_type' => MissionType::PERIOD,
//            'user_id' => $uid,
//        ]);
//
//        $today = date('Y-m-d');
//        $checked = Checkin::find(['challenge_id'=>$challenge->id])
//            ->where("unix_timestamp(checkin_time) > unix_timestamp($today)")
//            ->one();
//
//        if ($checked != null) {
//            return true;
//        }
//
//        $pending_count = PendingCheckin::find()->where(['user_id' => $uid])
//            ->andWhere(['challenge_id' => $challenge->id])
//            ->where("unix_timestamp(create_time) > unix_timestamp($today)")
//            ->andWhere('status >= 1')
//            ->andWhere('status <= 2')
//            ->count();
//
//        return $pending_count > 0 ? true : false;
//    }

  /**
     * å½“å‰å•ä½æ—¶é—´æ‰“å¡
     *
     * @return boolean
     * */
    public function getCheckinCountInUnit()
    {
        // å•æ¬¡æ‰“å¡ä»»åŠ¡
        if ($this->challenge->mission_type == MissionType::SINGLE){
            return ($this->checkinCount);
        } elseif ( $this->challenge->mission_type == MissionType::PERIOD ) {
        // å‘¨æœŸæ‰“å¡ä»»åŠ¡
            if ($this->mission->min_unit == CheckinUnit::HOUR) {
                return  (new \yii\db\Query())
                    ->from('checkin')
                    ->where("checkin.challenge_id = {$this->id} and TO_DAYS(checkin_time) == TO_DAYS(NOW()) and HOUR(checkin_time) ==  HOUR(NOW())")
                    ->count();
            } elseif ($this->mission->min_unit == CheckinUnit::DAY) {
                return  (new \yii\db\Query())
                    ->from('checkin')
                    ->where("checkin.challenge_id = {$this->id} and TO_DAYS(checkin_time) == TO_DAYS(NOW())")
                    ->count();
            } elseif ($this->mission->min_unit == CheckinUnit::WEEK) {
                return  (new \yii\db\Query())
                    ->from('checkin')
                    ->where("checkin.challenge_id = {$this->id} and WEEKOFYEAR(checkin_time) == WEEKOFYEAR(NOW())")
                    ->count();
            }
        }

        return 0;
    }

    /**
     * æ˜¯å¦å¯æ‰“å¡
     *
     * @return boolean
     * */
    public function canCheckin()
    {
        //ä»»åŠ¡å·²ç»å¼€å§‹ ä¸” å•ä½æ—¶é—´å†… æœªæ‰“å¡
        if ( $this->mission->isStarted() and  ($this->checkinCountInUnit == 0) ) {
            return true;
        }

        return false;
    }


------- 2016-08-18 14:15:05
datetime:

return date('Y-m-d H:i:s', strtotime($this->stop_time) + 60*10);

select * from checkin where unix_timestamp(checkin_time) > unix_timestamp('2016-08-14 17:39:05');


---------- 2016-08-17 18:16:35
mysql> select id, repeat, period from period_mission;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' period from period_mission' at line 1

mysql> select id, `repeat`, period from period_mission;

---------- 2016-08-17 15:36:45
datetime modification:
http://www.php100.com/html/webkaifa/database/Mysql/2009/0111/1160.html

mysql> update mission set start_time=NOW() where id=286;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from mission where id=286;

-------------- 2016-08-16 20:11:37

MySQLé‡ç½® Auto_incrementå­—æ®µèµ·å§‹å€¼
æœ‰2ç§æ–¹æ³•ï¼š
1.alter table tbname auto_increment = x  ; // if x < the current largest id, the auto id will grow on.
è®¾ç½®è¡¨tbnameçš„å”¯ä¸€auto_incrementå­—æ®µèµ·å§‹å€¼ä»xå¼€å§‹ï¼Œå¦‚æœæ­¤è¡¨æ•°æ®é‡å¾ˆå¤šçš„è¯ï¼Œè¿™æ ·æ‰§è¡Œèµ·æ¥ä¼šå¾ˆæ…¢ã€‚

2.truncate tbname ;
ç›´æ¥æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼Œä¸‹æ¬¡æ’å…¥æ•°æ®æ—¶auto_incrementå­—æ®µä¼šè‡ªåŠ¨ä»0å¼€å§‹ã€‚ å’Œdelete from tbnameä¸åŒçš„æ˜¯deleteåªåˆ é™¤æ•°æ®è€Œä¸é‡ç½®auto_incremnet.


---------- 2016-08-05 18:33:24
alter table `test_test` add column subscribed int(11) not null default 1 COMMENT '0: false, 1: true';

-------- 2016-08-05 17:22:06
numå­—æ®µä¸Šåˆ›å»ºç´¢å¼• æœ€æ™®é€šçš„æƒ…å†µï¼Œæ˜¯ä¸ºå‡ºç°åœ¨whereå­å¥çš„å­—æ®µå»ºä¸€ä¸ªç´¢å¼•ã€‚
ALTER TABLE `test_test` ADD INDEX `num_index` (`num`) ;

http://blog.sina.com.cn/s/blog_52d20fbf0100ofd5.html
å­˜å‚¨è¿‡ç¨‹æ˜¯æ•°æ®åº“å­˜å‚¨çš„ä¸€ä¸ªé‡è¦çš„åŠŸèƒ½ï¼Œä½†æ˜¯MySQLåœ¨5.0ä»¥å‰å¹¶ä¸æ”¯æŒå­˜å‚¨è¿‡ç¨‹ï¼Œè¿™ä½¿å¾—MySQLåœ¨åº”ç”¨ä¸Šå¤§æ‰“æŠ˜æ‰£ã€‚å¥½åœ¨MySQL 5.0ç»ˆäºå¼€å§‹å·²ç»æ”¯æŒå­˜å‚¨è¿‡ç¨‹ï¼Œè¿™æ ·å³å¯ä»¥å¤§å¤§æé«˜æ•°æ®åº“çš„å¤„ç†é€Ÿåº¦ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æé«˜æ•°æ®åº“ç¼–ç¨‹çš„çµæ´»æ€§ã€‚

CREATE TABLE `test_test` (
  `id` int(11) NOT NULL auto_increment,
  `num` int(11) NOT NULL default '0',
  PRIMARY KEY  (`id`)
 ) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

DELIMITER //
create procedure p_test_02(pa int(11)) 
begin
  declare max_num int(11) default 1000000;
  declare i int default 0;
  declare rand_num int;
   
  select count(id) into max_num from test_test; 
   
  while i < pa do 
    if max_num < 1000000 then 
      select cast(rand()*100 as unsigned) into rand_num; 
      insert into test_test(num) values(rand_num); 
    end if; 
    set i = i +1; 
  end while; 
end
//
DELIMITER ;

call p_test(1000000);

select distinct num from test_test;
select num from test_test group by num;

mysql> show profiles;
+----------+------------+----------------------------------------+
| Query_ID | Duration   | Query                                  |
+----------+------------+----------------------------------------+
|        1 | 0.02175600 | select distinct(num) from test_test    |
|        2 | 0.02197225 | select num from test_test group by num |
+----------+------------+----------------------------------------+
2 rows in set, 1 warning (0.00 sec)

mysql> explain select num from test_test group by num;
+----+-------------+-----------+------+---------------+------+---------+------+---------+---------------------------------+
| id | select_type | table     | type | possible_keys | key  | key_len | ref  | rows    | Extra                           |
+----+-------------+-----------+------+---------------+------+---------+------+---------+---------------------------------+
|  1 | SIMPLE      | test_test | ALL  | NULL          | NULL | NULL    | NULL | 1100000 | Using temporary; Using filesort |

http://www.cnblogs.com/cy163/archive/2008/10/27/1320798.html
after creating an index, the speed grows a lot faster:
|  2000014 | 0.23482675 | select distinct num from test_test                |
|  2000015 | 0.24779200 | select num from test_test group by num            |
|  2000016 | 0.00190925 | explain select num from test_test group by num    |
|  2000017 | 1.62457875 | create index test_test_num on test_test(num)      |
|  2000018 | 0.00492250 | select num from test_test group by num 

+----+-------------+-----------+------+---------------+------+---------+------+---------+---------------------------------+
mysql> explain select num from test_test group by num;
+----+-------------+-----------+-------+---------------+---------------+---------+------+------+--------------------------+
| id | select_type | table     | type  | possible_keys | key           | key_len | ref  | rows | Extra                    |
+----+-------------+-----------+-------+---------------+---------------+---------+------+------+--------------------------+
|  1 | SIMPLE      | test_test | range | test_test_num | test_test_num | 4       | NULL |  102 | Using index for group-by |
+----+-------------+-----------+-------+---------------+---------------+---------+------+------+--------------------------+

å¦‚æœä½ çš„æ•°æ®åº“éå¸¸å·¨å¤§ï¼Œå¹¶ä¸”æ¯æ—¥çš„é¡µé¢è¯·æ±‚è¾¾ä¸Šç™¾ä¸‡ç®—ï¼Œæˆ‘æƒ³ä½ ä¼šè·ç›Šè‰¯å¤šçš„ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ è¦åšæ›´ä¸ºå¤æ‚çš„æŸ¥è¯¢å‘¢ï¼Œä¾‹å¦‚å°†å¤šå¼ è¡¨ç»“åˆèµ·æ¥æŸ¥è¯¢ï¼Œç‰¹åˆ«æ˜¯whereé™åˆ¶å­—å¥ä¸­çš„å­—æ®µæ˜¯æ¥è‡ªä¸æ­¢ä¸€ä¸ªè¡¨æ ¼æ—¶ï¼Œåº”è¯¥æ€æ ·å¤„ç†å‘¢ï¼Ÿæˆ‘é€šå¸¸éƒ½å°½é‡é¿å…è¿™ç§åšæ³•ï¼Œå› ä¸ºè¿™æ ·æ•°æ®åº“è¦å°†å„ä¸ªè¡¨ä¸­çš„ä¸œè¥¿éƒ½ç»“åˆèµ·æ¥ï¼Œç„¶åå†æ’é™¤é‚£äº›ä¸åˆé€‚çš„è¡Œï¼Œæä¸å¥½å¼€é”€ä¼šå¾ˆå¤§ã€‚

  å¦‚æœä¸èƒ½é¿å…ï¼Œä½ åº”è¯¥æŸ¥çœ‹æ¯å¼ è¦ç»“åˆèµ·æ¥çš„è¡¨ï¼Œå¹¶ä¸”ä½¿ç”¨ä»¥ä¸Šçš„ç­–ç•¥æ¥å»ºç«‹ç´¢å¼•ï¼Œç„¶åå†ç”¨EXPLAINå‘½ä»¤éªŒè¯ä¸€ä¸‹æ˜¯å¦ä½¿ç”¨äº†ä½ æ–™æƒ³ä¸­çš„ç´¢å¼•ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œå°±OKã€‚ä¸æ˜¯çš„è¯ï¼Œä½ å¯èƒ½è¦å»ºç«‹ä¸´æ—¶çš„è¡¨æ¥å°†ä»–ä»¬ç»“åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸”ä½¿ç”¨é€‚å½“çš„ç´¢å¼•ã€‚

  è¦æ³¨æ„çš„æ˜¯ï¼Œå»ºç«‹å¤ªå¤šçš„ç´¢å¼•å°†ä¼šå½±å“æ›´æ–°å’Œæ’å…¥çš„é€Ÿåº¦ï¼Œå› ä¸ºå®ƒéœ€è¦åŒæ ·æ›´æ–°æ¯ä¸ªç´¢å¼•æ–‡ä»¶ã€‚å¯¹äºä¸€ä¸ªç»å¸¸éœ€è¦æ›´æ–°å’Œæ’å…¥çš„è¡¨æ ¼ï¼Œå°±æ²¡æœ‰å¿…è¦ä¸ºä¸€ä¸ªå¾ˆå°‘ä½¿ç”¨çš„whereå­—å¥å•ç‹¬å»ºç«‹ç´¢å¼•äº†ï¼Œå¯¹äºæ¯”è¾ƒå°çš„è¡¨ï¼Œæ’åºçš„å¼€é”€ä¸ä¼šå¾ˆå¤§ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦å»ºç«‹å¦å¤–çš„ç´¢å¼•ã€‚

----------- 2016-08-05 15:29:48
mysqlæ›´æ”¹è¡¨ç»“æ„ï¼šæ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹å­—æ®µã€è°ƒæ•´å­—æ®µé¡ºåº 
  alter table `user_movement_log` Add column GatewayId int not null default 0 AFTER `Regionid`

------------- 2016-08-05 12:18:51
yii pdo with mysql

    public function actionStats()
    {
        $scenes = QrMessage::findBySql('select event_key, sum(count) as scan_count, count(event_key) as user_count from qrcode_general group by event_key')->all();
        return $this->render('stats', ['scenes' => $scenes]);
    }

class QrMessage extends \yii\db\ActiveRecord
{
    public $user_count;
    public $scan_count;
    public static function tableName()
    {
        return 'qrcode_general';
    }

    public function rules()
    {
        return [];
    }
}

http://www.yiichina.com/doc/guide/2.0/start-databases
public function actionIndex()
    {
        $query = Country::find();

        $pagination = new Pagination([
            'defaultPageSize' => 5,
            'totalCount' => $query->count(),
        ]);

        $countries = $query->orderBy('name')
            ->offset($pagination->offset)
            ->limit($pagination->limit)
            ->all();

        return $this->render('index', [
            'countries' => $countries,
            'pagination' => $pagination,
        ]);
    }
------------- 2016-08-04 15:37:36

select max(id) from t5;
mysql> select * from qrcode_general where scene_id like '%1111';
  ORå¯ä»¥å’ŒANDä¸€èµ·ä½¿ç”¨ã€‚å½“ä¸¤è€…ä¸€èµ·ä½¿ç”¨æ—¶ï¼ŒANDè¦æ¯”ORå…ˆè¿ç®—ã€‚
SELECT * FROM employee WHERE num IN(1,3,4) AND age=25 OR sex='å¥³';
  ANDå’ŒORå…³é”®å­—å¯ä»¥è¿æ¥æ¡ä»¶è¡¨è¾¾å¼ã€‚è¿™äº›æ¡ä»¶è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨â€œ=â€ã€â€œ>â€ç­‰æ“ä½œç¬¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨INã€BETWEEN ANDå’ŒLIKEç­‰å…³é”®å­—ï¼Œè€Œä¸”ï¼ŒLIKEå…³é”®å­—åŒ¹é…å­—ç¬¦ä¸²æ—¶å¯ä»¥ä½¿ç”¨â€œ%â€å’Œâ€œ_â€ç­‰é€šé…ç¬¦ã€‚

mysql> select * from states order by population limit 4 offset 1;
select name,sum(score) ,avg(score) from result group by name;
1. select scene_id, sum(count) from qrcode_general group by scene_id;
2. duplicated subscription

select count(distinct name) from result; 
  get the number of different names in the table.
select distinct name from result;
  return all different name, no duplication.
select name, score from result group by name;
  return no duplicated name with one of his/her scores.

http://www.cnblogs.com/zox2011/archive/2012/09/12/2681797.html
ç”¨distinctçš„æ—¶å€™ï¼Œå¦‚æœå®ƒæœ‰ç´¢å¼•ï¼Œmysqlä¼šæŠŠå®ƒè½¬æˆgroup byçš„æ–¹å¼æ‰§è¡Œã€‚
åŠ äº†ç´¢å¼•ä¹‹å distinct æ¯”æ²¡åŠ ç´¢å¼•çš„ distinct å¿«äº† 107å€ã€‚
åŠ äº†ç´¢å¼•ä¹‹å group by æ¯”æ²¡åŠ ç´¢å¼•çš„ group by å¿«äº† 43å€ã€‚
å†æ¥å¯¹æ¯” ï¼šdistinct  å’Œ group by
ä¸ç®¡æ˜¯åŠ ä¸åŠ ç´¢å¼• group by éƒ½æ¯” distinct å¿«ã€‚å› æ­¤ä½¿ç”¨çš„æ—¶å€™å»ºè®®é€‰ group by 

SELECT INTO FROMè¯­å¥
è¯­å¥å½¢å¼ä¸ºï¼šSELECT vale1, value2 into Table2 from Table1
è¦æ±‚ç›®æ ‡è¡¨Table2ä¸å­˜åœ¨ï¼Œå› ä¸ºåœ¨æ’å…¥æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºè¡¨Table2ï¼Œå¹¶å°†Table1ä¸­æŒ‡å®šå­—æ®µæ•°æ®å¤åˆ¶åˆ°Table2ä¸­ ã€‚

------------- 2016-08-04 17:17:46
æ•°æ®åº“ä¸­çš„æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨è¡¨ä¸­çš„ï¼Œè€Œè§†å›¾åªæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨ä¾ç…§æŸä¸ªæ¡ä»¶ç»„åˆè€Œæˆçš„ç»“æœé›†ï¼Œä¸€èˆ¬æ¥è¯´ä½ å¯ä»¥ç”¨updateï¼Œinsertï¼Œdeleteç­‰sqlè¯­å¥ä¿®æ”¹è¡¨ä¸­çš„æ•°æ®ï¼Œè€Œå¯¹è§†å›¾åªèƒ½è¿›è¡Œselectæ“ä½œã€‚ä½†æ˜¯ä¹Ÿå­˜åœ¨å¯æ›´æ–°çš„è§†å›¾ï¼Œå¯¹äºè¿™ç±»è§†å›¾çš„updateï¼Œinsertå’Œdeleteç­‰æ“ä½œæœ€ç»ˆä¼šä½œç”¨äºä¸å…¶ç›¸å…³çš„è¡¨ä¸­æ•°æ®ã€‚å› æ­¤ï¼Œè¡¨æ˜¯æ•°æ®åº“ä¸­æ•°æ®å­˜å‚¨çš„åŸºç¡€ï¼Œè€Œè§†å›¾åªæ˜¯ä¸ºäº†æ»¡è¶³æŸç§æŸ¥è¯¢è¦æ±‚è€Œå»ºç«‹çš„ä¸€ä¸ªå¯¹è±¡ã€‚

------------- 2016-08-04 17:04:39
http://www.blogjava.net/Johnny-Ajun/archive/2011/08/28/357445.html
havingå­—å¥å¯ä»¥è®©æˆ‘ä»¬ç­›é€‰æˆç»„åçš„å„ç§æ•°æ®ï¼Œwhereå­—å¥åœ¨èšåˆå‰å…ˆç­›é€‰è®°å½•ï¼Œä¹Ÿå°±æ˜¯è¯´ä½œç”¨åœ¨group byå’Œhavingå­—å¥å‰ã€‚è€Œ havingå­å¥åœ¨èšåˆåå¯¹ç»„è®°å½•è¿›è¡Œç­›é€‰ã€‚
whereå’Œhavingå­å¥éƒ½å¯ä»¥å®ç°è¿‡æ»¤è®°å½•çš„åŠŸèƒ½,ä½†ä»–ä»¬çš„ç”¨æ³•è¿˜æ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„,çœ‹ä¸€ä¾‹å­:
ç”¨group byå’Œhavingå­å¥è”åˆæ¥æŸ¥å‡ºä¸é‡å¤çš„è®°å½•,sqlå¦‚ä¸‹:
select uid,email,count(*) as ct from `edm_user081217` GROUP BY email
ç„¶åçœ‹è¿™ä¸ªï¼Œå°±å®¹æ˜“ç†è§£äº†
select uid,email,count(*) as ct from `edm_user081217` GROUP BY email HAVING ct > 1
å…ˆç”¨group by å¯¹emailè¿›è¡Œåˆ†ç»„,åœ¨ç”¨havingæ¥è¿‡æ»¤å¤§äº1çš„,è¿™æ ·æŸ¥æ‰¾å‡ºæ¥çš„å°±æ˜¯é‡å¤çš„è®°å½•äº†.
WHERE å­å¥ä½œç”¨äºè¡¨å’Œè§†å›¾ï¼ŒHAVING å­å¥ä½œç”¨äºç»„ã€‚
WHERE åœ¨åˆ†ç»„å’Œèšé›†è®¡ç®—ä¹‹å‰é€‰å–è¾“å…¥è¡Œï¼ˆå› æ­¤ï¼Œå®ƒæ§åˆ¶å“ªäº›è¡Œè¿›å…¥èšé›†è®¡ç®—ï¼‰ï¼Œ è€Œ HAVING åœ¨åˆ†ç»„å’Œèšé›†ä¹‹åé€‰å–åˆ†ç»„çš„è¡Œã€‚å› æ­¤ï¼ŒWHERE å­å¥ä¸èƒ½åŒ…å«èšé›†å‡½æ•°ï¼› å› ä¸ºè¯•å›¾ç”¨èšé›†å‡½æ•°åˆ¤æ–­é‚£äº›è¡Œè¾“å…¥ç»™èšé›†è¿ç®—æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ ç›¸åï¼ŒHAVING å­å¥æ€»æ˜¯åŒ…å«èšé›†å‡½æ•°ã€‚ï¼ˆä¸¥æ ¼è¯´æ¥ï¼Œä½ å¯ä»¥å†™ä¸ä½¿ç”¨èšé›†çš„ HAVING å­å¥ï¼Œ ä½†è¿™æ ·åšåªæ˜¯ç™½è´¹åŠ²ã€‚åŒæ ·çš„æ¡ä»¶å¯ä»¥æ›´æœ‰æ•ˆåœ°ç”¨äº WHERE é˜¶æ®µã€‚ï¼‰
åœ¨å‰é¢çš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ WHERE é‡Œåº”ç”¨åŸå¸‚åç§°é™åˆ¶ï¼Œå› ä¸ºå®ƒä¸éœ€è¦èšé›†ã€‚ è¿™æ ·æ¯”åœ¨ HAVING é‡Œå¢åŠ é™åˆ¶æ›´åŠ é«˜æ•ˆï¼Œå› ä¸ºæˆ‘ä»¬é¿å…äº†ä¸ºé‚£äº›æœªé€šè¿‡ WHERE æ£€æŸ¥çš„è¡Œè¿›è¡Œåˆ†ç»„å’Œèšé›†è®¡ç®—
ç»¼ä¸Šæ‰€è¿°ï¼š
havingä¸€èˆ¬è·Ÿåœ¨group byä¹‹åï¼Œæ‰§è¡Œè®°å½•ç»„é€‰æ‹©çš„ä¸€éƒ¨åˆ†æ¥å·¥ä½œçš„ã€‚
whereåˆ™æ˜¯æ‰§è¡Œæ‰€æœ‰æ•°æ®æ¥å·¥ä½œçš„ã€‚
å†è€…havingå¯ä»¥ç”¨èšåˆå‡½æ•°ï¼Œå¦‚having sum(qty)>1000
åŸé“¾æ¥ï¼šhttp://hi.baidu.com/ww999/blog/item/f330c8d3073107d0a8ec9a72.html

------------- 2016-08-04 17:02:35

DROP TABLE IF EXISTS `result`;
CREATE TABLE `result` (
`name` varchar(20) default NULL,
`subject` varchar(20) default NULL,
`score` tinyint(4) default NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

insert into result values
  ('å¼ ä¸‰','æ•°å­¦',90),
  ('å¼ ä¸‰','è¯­æ–‡',50),
  ('å¼ ä¸‰','åœ°ç†',40),
  ('æå››','è¯­æ–‡',55),
  ('æå››','æ”¿æ²»',45),
  ('ç‹äº”','æ”¿æ²»',30),
  ('èµµå…­','è¯­æ–‡',100),
  ('èµµå…­','æ•°å­¦',99),
  ('èµµå…­','å“å¾·',98);

mysql> select name,sum(score < 60) ,avg(score) from result group by name having sum(score<60) >=2; 
+--------+-----------------+------------+
| name   | sum(score < 60) | avg(score) |
+--------+-----------------+------------+
| å¼ ä¸‰   |               2 |    60.0000 |
| æå››   |               2 |    50.0000 |
+--------+-----------------+------------+
2 rows in set (0.01 sec)

mysql> select name,sum(score) ,avg(score) from result group by name having sum(score<60) >=2;
+--------+------------+------------+
| name   | sum(score) | avg(score) |
+--------+------------+------------+
| å¼ ä¸‰   |        180 |    60.0000 |
| æå››   |        100 |    50.0000 |
+--------+------------+------------+
2 rows in set (0.00 sec)




---------- 2016-08-04 14:19:09
sample .sql


DROP TABLE IF EXISTS `account`;
CREATE TABLE `account` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `open_id` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `union_id` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `avatar` varchar(1024) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `nickname` varchar(200) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `username` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `gender` int(11) DEFAULT '0' COMMENT '1: ç”·, 2: å¥³',
  `province` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `city` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `country` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `birthday` varchar(10) COLLATE utf8mb4_unicode_ci DEFAULT '',
  `privilege` varchar(10) COLLATE utf8mb4_unicode_ci DEFAULT '',
  `interest` varchar(10) COLLATE utf8mb4_unicode_ci DEFAULT '',
  `phone` varchar(10) COLLATE utf8mb4_unicode_ci DEFAULT '',
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `phone_index` (`phone`)
) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

datetime:
INSERT INTO `qrcode_general` VALUES (1, 'okpkfv0u2gC1rJauNZ_Qm6lJ8Aew','gh_d790e147d0b7',1,'qrscene_1111','2009-9-9 23:22:11',1);

æƒ³insertä¸€æ¡æ•°æ®ï¼Œå¦‚ä½•ä½¿ç”¨è¿™ä¸ªidå­—æ®µè®©å®ƒè‡ªåŠ¨å¢åŠ å‘¢: null
INSERT INTO `qrcode_general` VALUES (null, 'okpkfv0u2gC1rJauNZ_Qm6lJ8Aew','gh_d790e147d0b7',1,'qrscene_1111','2009-9-9 23:22:11',1);

AUTO_INCREMENT seems to be actually start from at least 1 instead of 0: æ²¡æœ‰æœ€å¤§å€¼ä¸Šé™?
tryingn to "insert into t5 values(0);", but the new item was with an incrementing id instead of 0.
$ mysql -V
mysql  Ver 14.14 Distrib 5.6.31, for Linux (x86_64) using  EditLine wrapper

http://blog.csdn.net/HW_LiBo/article/details/40097125 å¯¹äºinnodbè¡¨ï¼Œupdate auto_incrementå­—æ®µï¼Œå¦‚æœåˆ—å€¼ä¸å·²æœ‰çš„å€¼é‡å¤ï¼Œåˆ™ä¼šå‡ºé”™ï¼›å¦‚æœå¤§äºå·²æœ‰çš„æœ€å¤§å€¼ï¼Œå¯èƒ½ä¼šå¼•å…¥ä¸€ä¸ªå‘ï¼Œä¼šé€ æˆç¼–å·é‡å¤é”™è¯¯ï¼Œæ’å…¥æ•°æ®å¤±è´¥çš„æƒ…å†µï¼Œå¯è§åœ¨updateè‡ªå¢åˆ—å€¼æ˜¯è¦æ³¨æ„ã€‚
  InnoDBè¡¨updateè‡ªå¢åˆ—æ—¶ï¼Œç”±å¤§å€¼æ”¹ä¸ºå°å€¼ï¼Œé™¤äº†å¯èƒ½ä¼šå‡ºç°é‡å¤æ•°æ®ä¿®æ”¹å¤±è´¥å¤–ï¼Œæ²¡æœ‰å…¶ä»–é£é™©ã€‚
  InnoDBè¡¨updateè‡ªå¢åˆ—ï¼Œç”±å°æ”¹å¤§ 
  MyISAMè¡¨çš„updateè‡ªå¢åˆ—ä¸ä¼šå­˜åœ¨é£é™©ã€‚

some workaround: alter table t5 AUTO_INCREMENT=20;

test.sql
  CREATE TABLE `t5` (  
    `id` int(10) unsigned NOT NULL AUTO_INCREMENT,  
    PRIMARY KEY (`id`)  
  ) ENGINE=InnoDB;

  insert into t5 values(null);
  insert into t5 values(5),(9);
  insert into t5 values(null);

mysql> select * from t5;
+----+
| id |
+----+
|  1 |
|  5 |
|  9 |
| 10 |
+----+
4 rows in set (0.00 sec)

mysql> update t5 set id=12 where id=5;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from t5;
+----+
| id |
+----+
|  1 |
|  9 |
| 10 |
| 12 |
+----+
4 rows in set (0.00 sec)

mysql> insert into t5 values(null);
Query OK, 1 row affected (0.02 sec)

mysql> select * from t5;
+----+
| id |
+----+
|  1 |
|  9 |
| 10 |
| 11 |
| 12 |
+----+
5 rows in set (0.01 sec)


------------- 2016-08-04 15:27:26
mysql> show create table qrcode_general;
+----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table          | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| qrcode_general | CREATE TABLE `qrcode_general` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `open_id` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `to_id` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `event` int(11) NOT NULL COMMENT '0: scan, 1: subscribe',
  `scene_id` varchar(72) COLLATE utf8mb4_unicode_ci NOT NULL,
  `create_time` datetime NOT NULL,
  `count` int(11) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci |
+----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> desc qrcode_general;
+-------------+---------------------+------+-----+---------+----------------+
| Field       | Type                | Null | Key | Default | Extra          |
+-------------+---------------------+------+-----+---------+----------------+
| id          | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| open_id     | varchar(50)         | NO   |     | NULL    |                |
| to_id       | varchar(50)         | NO   |     | NULL    |                |
| event       | int(11)             | NO   |     | NULL    |                |
| scene_id    | varchar(72)         | NO   |     | NULL    |                |
| create_time | datetime            | NO   |     | NULL    |                |
| count       | int(11)             | NO   |     | NULL    |                |
+-------------+---------------------+------+-----+---------+----------------+
7 rows in set (0.00 sec)

mysql> show full columns from qrcode_general;
+-------------+---------------------+--------------------+------+-----+---------+----------------+---------------------------------+-----------------------+
| Field       | Type                | Collation          | Null | Key | Default | Extra          | Privileges                      | Comment               |
+-------------+---------------------+--------------------+------+-----+---------+----------------+---------------------------------+-----------------------+
| id          | bigint(20) unsigned | NULL               | NO   | PRI | NULL    | auto_increment | select,insert,update,references |                       |
| open_id     | varchar(50)         | utf8mb4_unicode_ci | NO   |     | NULL    |                | select,insert,update,references |                       |
| to_id       | varchar(50)         | utf8mb4_unicode_ci | NO   |     | NULL    |                | select,insert,update,references |                       |
| event       | int(11)             | NULL               | NO   |     | NULL    |                | select,insert,update,references | 0: scan, 1: subscribe |
| scene_id    | varchar(72)         | utf8mb4_unicode_ci | NO   |     | NULL    |                | select,insert,update,references |                       |
| create_time | datetime            | NULL               | NO   |     | NULL    |                | select,insert,update,references |                       |
| count       | int(11)             | NULL               | NO   |     | NULL    |                | select,insert,update,references |                       |
+-------------+---------------------+--------------------+------+-----+---------+----------------+---------------------------------+-----------------------+
7 rows in set (0.01 sec)


------------ 2016-08-04 10:32:29
mysql export

below 2 cmds generate the same output ä»…ä»…å¯¼å‡ºæ•°æ®åº“çš„ç»“æ„
$ mysqldump -h localhost -u root -p -d --add-drop-table yii2basic > yii2basic_drop_table.sql
$ mysqldump -h localhost -u root -p -d yii2basic > yii2basic_drop_table.sql

below cmd will also insert data for tables: [in an over-writing manner]
$ mysqldump -h localhost -u root -p yii2basic > yii2basic.sql

ä»…ä»…å¯¼å‡ºè¡¨çš„ç»“æ„
mysqldump -h127.0.0.1 -uroot -p -d --add-drop-table emlog emlog_blog > emlog_blog_structure.sql

å¯¼å…¥çš„è¯,æœ‰å¾ˆå¤šç§æ–¹æ³•,æœ€å•çš„å°±æ˜¯sourceå‘½ä»¤,å…ˆç”¨mysqlå‘½ä»¤è¿æ¥ä¸Šæ•°æ®åº“.ç„¶åç”¨sourceå¯¼å…¥æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å°±å¯ä»¥äº†.
mysql> source /home/kidd/tmp/yii2basic_drop_table.sql
Query OK, 0 rows affected (0.00 sec)
..............
mysql> show tables;
+---------------------+
| Tables_in_yii2basic |
+---------------------+
| country             |
| states              |
+---------------------+
2 rows in set (0.00 sec)
mysql> select * from country;
Empty set (0.00 sec)
mysql> select  * from states;
Empty set (0.00 sec)

notice that the original data is all cleared.

to import the backup data: source /home/kidd/tmp/yii2basic.sql

------------ 2016-08-04 10:24:52

$ mysqldump -h localhost -u root -p yii2basic states > states.sql
Enter password: 
$ ls
states.sql

mysqldump -h localhost -u root -p yii2basic > yii2basic.sql

å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„å‚æ•°æœ‰ -Pæˆ–--port è¦è¿æ¥çš„æœåŠ¡å™¨ç«¯å£,å¦‚æœMySQLçš„ç«¯å£ä¸æ˜¯3306,å°±è¦ç”¨åˆ°è¿™ä¸ªå‚æ•° -dæˆ–--no-data æ²¡æœ‰è¯¦ç»†æ•°æ®,ä»…ä»…å¯¼å‡ºæ•°æ®çš„ç»“æ„

-Pæˆ–--port          è¦è¿æ¥çš„æœåŠ¡å™¨ç«¯å£,å¦‚æœMySQLçš„ç«¯å£ä¸æ˜¯3306,å°±è¦ç”¨åˆ°è¿™ä¸ªå‚æ•°
-dæˆ–--no-data       æ²¡æœ‰è¯¦ç»†æ•°æ®,ä»…ä»…å¯¼å‡ºæ•°æ®çš„ç»“æ„
--add-drop-database åœ¨åˆ›å»ºæ•°æ®åº“æ—¶,å…ˆdropæ‰å·²ç»å­˜åœ¨çš„åŒåæ•°æ®åº“[ä¸€èˆ¬è·Ÿåœ¨-då‚æ•°å]
--add-drop-table    åœ¨åˆ›å»ºè¡¨æ—¶,å…ˆdropæ‰å·²ç»å­˜åœ¨çš„åŒåè¡¨[ä¸€èˆ¬è·Ÿåœ¨-då‚æ•°å]


----------- 2016-08-03 21:13:04

SQL limit offset
ç»å¸¸ç”¨åˆ°åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢ä¸­é—´å‡ æ¡æ•°æ®çš„éœ€æ±‚
æ¯”å¦‚ä¸‹é¢çš„sqlè¯­å¥ï¼š
â‘  select * from testtable limit 2,1;
â‘¡ select * from testtable limit 2 offset 1;
è¿™ä¸¤ä¸ªéƒ½æ˜¯èƒ½å®Œæˆéœ€è¦ï¼Œä½†æ˜¯ä»–ä»¬ä¹‹é—´æ˜¯æœ‰åŒºåˆ«çš„ï¼š
â‘ æ˜¯ä»æ•°æ®åº“ä¸­ç¬¬ä¸‰æ¡å¼€å§‹æŸ¥è¯¢ï¼Œå–ä¸€æ¡æ•°æ®ï¼Œå³ç¬¬ä¸‰æ¡æ•°æ®
â‘¡æ˜¯ä»æ•°æ®åº“ä¸­çš„ç¬¬äºŒæ¡æ•°æ®å¼€å§‹æŸ¥è¯¢ä¸¤æ¡æ•°æ®ï¼Œå³ç¬¬äºŒæ¡å’Œç¬¬ä¸‰æ¡ã€‚

mysql> select * from country order by population;
+------+----------------+------------+
| code | name           | population |
+------+----------------+------------+
| KI   | Kidd           |          1 |
| B    | Boy            |          2 |
| JP   | Japan          |    1111111 |
| CA   | Canada         |    1147000 |
| AU   | Australia      |   18886000 |
| FR   | France         |   59225700 |
| GB   | United Kingdom |   59623400 |
| DE   | Germany        |   82164700 |
| RU   | Russia         |  146934000 |
| BR   | Brazil         |  170115000 |
| US   | United States  |  278357000 |
| IN   | India          | 1013662000 |
| CN   | China          | 1277558000 |
+------+----------------+------------+
13 rows in set (0.00 sec)

mysql> select * from country order by population limit 2 offset 3;
+------+-----------+------------+
| code | name      | population |
+------+-----------+------------+
| CA   | Canada    |    1147000 |
| AU   | Australia |   18886000 |
+------+-----------+------------+
2 rows in set (0.00 sec)


-------------- 2016-08-03 20:55:42
yii pdo

http://www.yiichina.com/doc/guide/2.0/start-databases
åˆ›å»ºæ´»åŠ¨è®°å½•
åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªæ´»åŠ¨è®°å½•ç±»çš„ç±» Countryï¼Œ æŠŠå®ƒæ”¾åœ¨ models/Country.php æ–‡ä»¶ï¼Œå»ä»£è¡¨å’Œè¯»å– country è¡¨çš„æ•°æ®ã€‚
<?php
namespace app\models;
use yii\db\ActiveRecord;
class Country extends ActiveRecord
{
}
è¿™ä¸ª Country ç±»ç»§æ‰¿è‡ª yii\db\ActiveRecordã€‚ä½ ä¸ç”¨åœ¨é‡Œé¢å†™ä»»ä½•ä»£ç ã€‚ åªéœ€è¦åƒç°åœ¨è¿™æ ·ï¼ŒYii å°±èƒ½æ ¹æ®ç±»åå»çŒœæµ‹å¯¹åº”çš„æ•°æ®è¡¨åã€‚
    æ³¨æ„ï¼šå¦‚æœç±»åå’Œæ•°æ®è¡¨åä¸èƒ½ç›´æ¥å¯¹åº”ï¼Œå¯ä»¥è¦†å†™ yii\db\ActiveRecord::tableName() æ–¹æ³•å»æ˜¾å¼æŒ‡å®šç›¸å…³è¡¨åã€‚
ä½¿ç”¨ Country ç±»å¯ä»¥å¾ˆå®¹æ˜“åœ°æ“ä½œ country è¡¨æ•°æ®ï¼Œå°±åƒè¿™æ®µä»£ç ï¼š
use app\models\Country;
// è·å– country è¡¨çš„æ‰€æœ‰è¡Œå¹¶ä»¥ name æ’åº
$countries = Country::find()->orderBy('name')->all();
// è·å–ä¸»é”®ä¸º â€œUSâ€ çš„è¡Œ
$country = Country::findOne('US');
// è¾“å‡º â€œUnited Statesâ€
echo $country->name;
// ä¿®æ”¹ name ä¸º â€œU.S.A.â€ å¹¶åœ¨æ•°æ®åº“ä¸­ä¿å­˜æ›´æ”¹
$country->name = 'U.S.A.';
$country->save();
    è¡¥å……ï¼šæ´»åŠ¨è®°å½•æ˜¯é¢å‘å¯¹è±¡ã€åŠŸèƒ½å¼ºå¤§çš„è®¿é—®å’Œæ“ä½œæ•°æ®åº“æ•°æ®çš„æ–¹å¼ã€‚ä½ å¯ä»¥åœ¨æ´»åŠ¨è®°å½•ç« èŠ‚äº†è§£æ›´å¤šä¿¡æ¯ã€‚ é™¤æ­¤ä¹‹å¤–ä½ è¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ›´åŸç”Ÿçš„è¢«ç§°åšæ•°æ®è®¿é—®å¯¹è±¡çš„æ–¹æ³•æ“ä½œæ•°æ®åº“æ•°æ®ã€‚
åˆ›å»ºæ“ä½œ
ä¸ºäº†å‘æœ€ç»ˆç”¨æˆ·æ˜¾ç¤ºå›½å®¶æ•°æ®ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªæ“ä½œã€‚ ç›¸æ¯”ä¹‹å‰å°èŠ‚æŒæ¡çš„åœ¨ site æ§åˆ¶å™¨ä¸­åˆ›å»ºæ“ä½œï¼Œ åœ¨è¿™é‡Œä¸ºæ‰€æœ‰å’Œå›½å®¶æœ‰å…³çš„æ•°æ®æ–°å»ºä¸€ä¸ªæ§åˆ¶å™¨æ›´åŠ åˆç†ã€‚ æ–°æ§åˆ¶å™¨åä¸º CountryControllerï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ª index æ“ä½œï¼Œå¦‚ä¸‹ï¼š
<?php
namespace app\controllers;
use yii\web\Controller;
use yii\data\Pagination;
use app\models\Country;
class CountryController extends Controller
{
    public function actionIndex()
    {
        $query = Country::find();
        $pagination = new Pagination([
            'defaultPageSize' => 5,
            'totalCount' => $query->count(),
        ]);
        $countries = $query->orderBy('name')
            ->offset($pagination->offset)
            ->limit($pagination->limit)
            ->all();
        return $this->render('index', [
            'countries' => $countries,
            'pagination' => $pagination,
        ]);
    }
}
æŠŠä¸Šé¢çš„ä»£ç ä¿å­˜åœ¨ controllers/CountryController.php æ–‡ä»¶ä¸­ã€‚
index æ“ä½œè°ƒç”¨äº†æ´»åŠ¨è®°å½• Country::find() æ–¹æ³•ï¼Œå»ç”ŸæˆæŸ¥è¯¢è¯­å¥å¹¶ä» country è¡¨ä¸­å–å›æ‰€æœ‰æ•°æ®ã€‚ ä¸ºäº†é™å®šæ¯ä¸ªè¯·æ±‚æ‰€è¿”å›çš„å›½å®¶æ•°é‡ï¼ŒæŸ¥è¯¢åœ¨ yii\data\Pagination å¯¹è±¡çš„å¸®åŠ©ä¸‹è¿›è¡Œåˆ†é¡µã€‚ Pagination å¯¹è±¡çš„ä½¿å‘½ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š
    ä¸º SQL æŸ¥è¯¢è¯­å¥è®¾ç½® offset å’Œ limit ä»å¥ï¼Œ ç¡®ä¿æ¯ä¸ªè¯·æ±‚åªéœ€è¿”å›ä¸€é¡µæ•°æ®ï¼ˆæœ¬ä¾‹ä¸­æ¯é¡µæ˜¯ 5 è¡Œï¼‰ã€‚
    åœ¨è§†å›¾ä¸­æ˜¾ç¤ºä¸€ä¸ªç”±é¡µç åˆ—è¡¨ç»„æˆçš„åˆ†é¡µå™¨ï¼Œ è¿™ç‚¹å°†åœ¨åé¢çš„æ®µè½ä¸­è§£é‡Šã€‚
åœ¨ä»£ç æœ«å°¾ï¼Œindex æ“ä½œæ¸²æŸ“ä¸€ä¸ªåä¸º index çš„è§†å›¾ï¼Œ å¹¶ä¼ é€’å›½å®¶æ•°æ®å’Œåˆ†é¡µä¿¡æ¯è¿›å»ã€‚
åˆ›å»ºè§†å›¾
åœ¨ views ç›®å½•ä¸‹å…ˆåˆ›å»ºä¸€ä¸ªåä¸º country çš„å­ç›®å½•ã€‚è¿™ä¸ªç›®å½•å­˜å‚¨æ‰€æœ‰ç”± country æ§åˆ¶å™¨æ¸²æŸ“çš„è§†å›¾ã€‚ åœ¨ views/country ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º index.php çš„è§†å›¾æ–‡ä»¶ï¼Œ å†…å®¹å¦‚ä¸‹ï¼š
<?php
use yii\helpers\Html;
use yii\widgets\LinkPager;
?>
<h1>Countries</h1>
<ul>
<?php foreach ($countries as $country): ?>
    <li>
        <?= Html::encode("{$country->name} ({$country->code})") ?>:
        <?= $country->population ?>
    </li>
<?php endforeach; ?>
</ul>
<?= LinkPager::widget(['pagination' => $pagination]) ?>
è¿™ä¸ªè§†å›¾åŒ…å«ä¸¤éƒ¨åˆ†ç”¨ä»¥æ˜¾ç¤ºå›½å®¶æ•°æ®ã€‚ç¬¬ä¸€éƒ¨åˆ†éå†å›½å®¶æ•°æ®å¹¶ä»¥æ— åº HTML åˆ—è¡¨æ¸²æŸ“å‡ºæ¥ã€‚ ç¬¬äºŒéƒ¨åˆ†ä½¿ç”¨ yii\widgets\LinkPager å»æ¸²æŸ“ä»æ“ä½œä¸­ä¼ æ¥çš„åˆ†é¡µä¿¡æ¯ã€‚ å°éƒ¨ä»¶ LinkPager æ˜¾ç¤ºä¸€ä¸ªåˆ†é¡µæŒ‰é’®çš„åˆ—è¡¨ã€‚ ç‚¹å‡»ä»»ä½•ä¸€ä¸ªæŒ‰é’®éƒ½ä¼šè·³è½¬åˆ°å¯¹åº”çš„åˆ†é¡µã€‚
è¯•è¿è¡Œ
æµè§ˆå™¨è®¿é—®ä¸‹é¢çš„ URL çœ‹çœ‹èƒ½å¦å·¥ä½œï¼š
http://localhost/index.php?r=country/index
http://localhost/index.php?r=states/index

below function is triggered on every call to http://localhost/index.php?r=states/index

class StatesController extends Controller
{
    public function actionIndex()


---------- 2016-08-03 20:03:20
yii & mysql
http://www.yiichina.com/doc/guide/2.0/start-databases

.sql
CREATE TABLE `country` (
  `code` CHAR(2) NOT NULL PRIMARY KEY,
  `name` CHAR(52) NOT NULL,
  `population` INT(11) NOT NULL DEFAULT '0'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `country` VALUES ('AU','Australia',18886000);
INSERT INTO `country` VALUES ('BR','Brazil',170115000);
INSERT INTO `country` VALUES ('CA','Canada',1147000);
INSERT INTO `country` VALUES ('CN','China',1277558000);
INSERT INTO `country` VALUES ('DE','Germany',82164700);
INSERT INTO `country` VALUES ('FR','France',59225700);
INSERT INTO `country` VALUES ('GB','United Kingdom',59623400);
INSERT INTO `country` VALUES ('IN','India',1013662000);
INSERT INTO `country` VALUES ('RU','Russia',146934000);
INSERT INTO `country` VALUES ('US','United States',278357000);

é…ç½®æ•°æ®åº“è¿æ¥
å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²ç»å®‰è£…äº† PHP PDO æ‰©å±•å’Œä½ æ‰€ä½¿ç”¨çš„æ•°æ®åº“çš„ PDO é©±åŠ¨ï¼ˆä¾‹å¦‚ MySQL çš„ pdo_mysqlï¼‰ã€‚ å¯¹äºä½¿ç”¨å…³ç³»å‹æ•°æ®åº“æ¥è®²ï¼Œè¿™æ˜¯åŸºæœ¬è¦æ±‚ã€‚

<?php
namespace app\models;
use yii\db\ActiveRecord;
class Country extends ActiveRecord
{
}
è¿™ä¸ª Country ç±»ç»§æ‰¿è‡ª yii\db\ActiveRecordã€‚ä½ ä¸ç”¨åœ¨é‡Œé¢å†™ä»»ä½•ä»£ç ã€‚ åªéœ€è¦åƒç°åœ¨è¿™æ ·ï¼ŒYii å°±èƒ½æ ¹æ®ç±»åå»çŒœæµ‹å¯¹åº”çš„æ•°æ®è¡¨åã€‚
    æ³¨æ„ï¼šå¦‚æœç±»åå’Œæ•°æ®è¡¨åä¸èƒ½ç›´æ¥å¯¹åº”ï¼Œå¯ä»¥è¦†å†™ yii\db\ActiveRecord::tableName() æ–¹æ³•å»æ˜¾å¼æŒ‡å®šç›¸å…³è¡¨åã€‚
ä½¿ç”¨ Country ç±»å¯ä»¥å¾ˆå®¹æ˜“åœ°æ“ä½œ country è¡¨æ•°æ®ï¼Œå°±åƒè¿™æ®µä»£ç ï¼š
use app\models\Country;
// è·å– country è¡¨çš„æ‰€æœ‰è¡Œå¹¶ä»¥ name æ’åº
$countries = Country::find()->orderBy('name')->all();
// è·å–ä¸»é”®ä¸º â€œUSâ€ çš„è¡Œ
$country = Country::findOne('US');
// è¾“å‡º â€œUnited Statesâ€
echo $country->name;
// ä¿®æ”¹ name ä¸º â€œU.S.A.â€ å¹¶åœ¨æ•°æ®åº“ä¸­ä¿å­˜æ›´æ”¹
$country->name = 'U.S.A.';
$country->save();
    è¡¥å……ï¼šæ´»åŠ¨è®°å½•æ˜¯é¢å‘å¯¹è±¡ã€åŠŸèƒ½å¼ºå¤§çš„è®¿é—®å’Œæ“ä½œæ•°æ®åº“æ•°æ®çš„æ–¹å¼ã€‚ä½ å¯ä»¥åœ¨æ´»åŠ¨è®°å½•ç« èŠ‚äº†è§£æ›´å¤šä¿¡æ¯ã€‚ é™¤æ­¤ä¹‹å¤–ä½ è¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ›´åŸç”Ÿçš„è¢«ç§°åšæ•°æ®è®¿é—®å¯¹è±¡çš„æ–¹æ³•æ“ä½œæ•°æ®åº“æ•°æ®ã€‚[http://www.yiichina.com/doc/guide/2.0/db-dao]


-------------- 2016-08-03 20:03:09
$ mysql -u root -p
mysql> create database yii2basic;
source basic/database/country.sql;
  another way: D:\mysql\bin\mysql â€“uroot â€“p123456 -Dtest<d:\test\ss.sql


------------ 2016-08-03 20:35:54
PDOæ‰©å±•ä¸ºPHPè®¿é—®æ•°æ®åº“å®šä¹‰äº†ä¸€ä¸ªè½»é‡çº§çš„ã€ä¸€è‡´æ€§çš„æ¥å£ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ•°æ®è®¿é—®æŠ½è±¡å±‚ï¼Œè¿™æ ·ï¼Œæ— è®ºä½¿ç”¨ä»€ä¹ˆæ•°æ®åº“ï¼Œéƒ½å¯ä»¥é€šè¿‡ä¸€è‡´çš„å‡½æ•°æ‰§è¡ŒæŸ¥è¯¢å’Œè·å–æ•°æ®ã€‚
åœ¨ä¸€äº›PHPç®¡ç†ç³»ç»Ÿéœ€è¦å¼€å¯PDOå’ŒPDO_MySQLæ‰©å±•ï¼Œæ–¹æ³•å¾ˆç®€å•ï¼š
1ã€æ‰¾åˆ°php.iniæ–‡ä»¶
2ã€æ‰“å¼€åï¼Œæœç´¢ extension=php_pdo.dll å’Œ extension=php_pdo_mysql.dll ï¼Œå»æ‰å‰é¢â€œ;â€çš„æ³¨é‡Šã€‚
æœ€ç»ˆè¿™ä¸¤è¡Œé…ç½®å†…å®¹å¦‚ä¸‹ï¼š
extension=php_pdo.dll
extension=php_pdo_mysql.dll
é‡æ–°å¯åŠ¨apacheæˆ–è€…iisåï¼Œåœ¨phpinfoå‡½æ•°ä¸­æŸ¥çœ‹ï¼Œæ˜¯å¦å¼€å¯ã€‚ 


------------- 2016-08-03 20:45:43
http://www.linuxdiyf.com/linux/15732.html
ubuntuä¸‹å®‰è£…å¥½LAMPåé»˜è®¤æƒ…å†µæ²¡æœ‰å®‰è£…mysql_pdoæ‰©å±•ï¼Œä»¥ä¸‹æ˜¯å®‰è£… æ­¥èšï¼Œåœ¨ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š
1ã€pecl search pdo
2ã€sudo pecl install pdo
å½“å‡ºç°sh: phpize: command  not foundè¿™äº›æç¤ºæ—¶å…ˆè¿è¡Œsudo apt-get install php5-dev
3ã€sudo pecl install pdo_mysql
å½“å‡ºç°configure: error: Cannot find MySQL header files under
ERROR: `/tmp/pear/temp/PDO_MYSQL/configure' failed
æç¤ºæ—¶å…ˆè¿è¡Œ
sudo apt-get install libmysqlclient15-dev
4ã€sudo gedit /etc/php5/apache2/php.ini
5ã€åœ¨æœ€åé¢åŠ å…¥ä»¥ä¸‹2è¡Œ
extension = pdo.so
extension = pdo_mysql.so
6ã€é‡å¯APACHE
sudo /etc/init.d/apache2 restart
æˆ‘åšä»¥ä¸Šæ“ä½œæ˜¯å› ä¸ºç”¨zend frameworkæ¡†åŠ æ—¶è¿æ¥æ•°æ®åº“å‡ºç°ä»¥ä¸‹æç¤º
Fatal error: Uncaught exception 'Zend_Db_Adapter_Exception' with message 'The mysql driver is not currently installed' in
Ubuntuä¸‹å®‰è£…PDOï¼šhttp://www.linuxdiyf.com/linux/15311.html
Ubuntuä¸‹çš„Mysqlæ— æ³•é€šè¿‡PDOè¿æ¥ï¼šhttp://www.linuxdiyf.com/linux/14337.html

/usr
$ fn pdo.so
./lib/php/20151012/pdo.so

http://www.jb51.net/article/60256.htm
PDOï¼ˆPHP Data Objectï¼‰æ‰©å±•ä¸ºPHPå®šä¹‰äº†ä¸€ä¸ªè®¿é—®æ•°æ®åº“çš„è½»é‡ã€æŒä¹…çš„æ¥å£ã€‚å®ç°PDOæ¥å£çš„æ¯ä¸€ç§æ•°æ®åº“é©±åŠ¨éƒ½èƒ½ä»¥æ­£åˆ™æ‰©å±•çš„å½¢å¼æŠŠå„è‡ªçš„ç‰¹è‰²è¡¨ç°å‡ºæ¥ã€‚
ä¸»è¦ï¼šPDOæ‰©å±•åªæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¥å£å±‚ï¼Œåˆ©ç”¨PDOæ‰©å±•æœ¬èº«å¹¶ä¸èƒ½å®ç°ä»»ä½•æ•°æ®åº“æ“ä½œï¼Œå¿…é¡»ä½¿ç”¨ä¸€ä¸ªç‰¹å®šçš„æ•°æ®åº“PDOé©±åŠ¨è®¿é—®æ•°æ®åº“

------------ 2016-08-05 15:47:31
sample .sql

DROP TABLE IF EXISTS `qrcode_general`;
CREATE TABLE `qrcode_general` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `from_id` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `to_id` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `event` varchar(11) NOT NULL,
  `event_key` varchar(72) COLLATE utf8mb4_unicode_ci NOT NULL,
  `create_time` datetime NOT NULL,
  `count` int(11) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

DROP TABLE IF EXISTS `qrcode_ticket`;
CREATE TABLE `qrcode_ticket` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `ticket` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL,
  `client_event_key` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL,
  `type` int(11) NOT NULL COMMENT '0: string, 1: integer',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

INSERT INTO `qrcode_general` VALUES (null, 'okpkfv0u2gC1rJauNZ_Qm6lJ8Aew','gh_d790e147d0b7',"subscribe",'qrscene_1111','2009-9-9 23:22:11',1);
INSERT INTO `qrcode_general` VALUES (null, 'okpkfv0u2gC1rJauNZ_Qm6lJ8Aew','gh_d790e147d0b7',"SCAN",'1111','2009-9-9 23:22:11',2);
INSERT INTO `qrcode_general` VALUES (null, 'okpkfv0u2gB1rJauNZ_Qm6lJ8Aew','gh_d790e147d0b7',"SCAN",'1111','2009-9-9 23:22:11',3);

INSERT INTO `qrcode_ticket` VALUES (null, 'gQHq8DoAAAAAAAAAASxodHRwOi8vd2VpeGluLnFxLmNvbS9xL2EwUzJvaWZsUDVoRzROR3lCR2hXAAIEa8KhVwMEAAAAAA==', '1111', 1);


---------------- 2016-10-09 01:41:58
http://www.cnblogs.com/zhangronghua/archive/2008/03/12/1102744.html

åˆšåˆšå¼€å§‹å­¦ä¹ PHPï¼Œä¸€åˆ‡éƒ½æ„Ÿè§‰å¾ˆæ–°é²œï¼Œä¹Ÿæœ‰å¾ˆå¤šä¸æ‡‚çš„åœ°æ–¹ï¼Œä»Šå¤©å°±é‡åˆ°äº†ä¸€ä¸ªéº»çƒ¦ã€‚åœ¨æŒ‰ç…§php5 MySQL5 apache2 phpmyadmin ZendOptimizerå®‰è£…ä¸é…ç½®[è½¬]ä¸€æ–‡ä¸­æŒ‡æ˜çš„è¿‡ç¨‹é…ç½®å¥½phpç¯å¢ƒåï¼Œä¾¿å¼€å§‹å½•å…¥ï¼œPHPå’ŒMYSQL WEBå¼€å‘ï¼ä¸­çš„demoå­¦ä¹ ï¼Œå¯æ˜¯åœ¨è¿æ¥mysqlæ—¶é‡åˆ°äº†â€class 'mysqli' not found'çš„é”™è¯¯ã€‚ç¬¬ä¸€ååº”æ˜¯æ£€æŸ¥è‡ªå·±çš„é…ç½®ï¼Œåœ¨ç¡®è®¤æ˜¯æŒ‰ç…§æ­£ç¡®ä¸Šæ–‡ä»‹ç»çš„æ–¹æ³•é…ç½®åï¼Œè¿˜æ˜¯æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œåªèƒ½åˆ©ç”¨googleæœç´¢ã€‚æœ€åæ‰¾åˆ°è§£å†³æ–¹æ³•ï¼ŒåŸæ¥mysqliæ˜¯php5æ–°å¢ä¸­çš„å‡½æ•°åº“ï¼Œåœ¨ä¸Šæ–‡ä»‹ç»æ—¶ï¼Œå¹¶æ²¡æœ‰ä¸ºè¯¥å‡½æ•°åº“åšé…ç½®ï¼Œè¦æƒ³åœ¨phpä¸­ä½¿ç”¨mysqliå‡½æ•°åº“ï¼Œéœ€è¦å°†php.iniæ–‡ä»¶ä¸­â€œ;extension=php_mysqli.dll"è¡Œçš„;å»æ‰ã€‚è¿™æ ·å°±èƒ½è§£å†³è¿™ä¸ªé”™è¯¯äº†ã€‚
    å¾ˆç®€å•çš„ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºæ˜¯åˆå­¦è€…çš„åŸå› ï¼Œè´¹äº†ä¸å°‘äº‹ã€‚:)

http://blog.csdn.net/liehuo123/article/details/20044883
